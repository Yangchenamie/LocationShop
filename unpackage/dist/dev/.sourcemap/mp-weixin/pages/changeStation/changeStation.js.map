{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/86150/Desktop/locationShop/pages/changeStation/changeStation.vue?9413","webpack:///C:/Users/86150/Desktop/locationShop/pages/changeStation/changeStation.vue?af6f","webpack:///C:/Users/86150/Desktop/locationShop/pages/changeStation/changeStation.vue?847e","uni-app:///pages/changeStation/changeStation.vue","webpack:///C:/Users/86150/Desktop/locationShop/pages/changeStation/changeStation.vue?bcee","webpack:///C:/Users/86150/Desktop/locationShop/pages/changeStation/changeStation.vue?6c5d"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","msg","phone","name","hours","local","position","longitude","latitude","methods","onChooseAvatar","console","avatarUrl","e","getPhone","value","uni","title","icon","gotoIndex","url","getLocation","success","scope","that","fail","err","showModal","content","confirmText","then","authouName","complete","fnGetlocation","type","gotoChange","arr","header","method","res","pages","beforePage"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,sBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsI;AACtI;AACiE;AACL;AACsC;;;AAGlG;AACgK;AAChK,gBAAgB,6KAAU;AAC1B,EAAE,mFAAM;AACR,EAAE,oGAAM;AACR,EAAE,6GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA2lB,CAAgB,unBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;AC6B/mB;AAIA;AAGA;AAEA;AAAA;AAAA,eACA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC,yCACA;IACAC;MACAC;MACA,IACAC,YACAC,SADAD;MAEA;MACA;MACA;MACAD;MACA;MACAA;MACA;MACA;MACA;IACA;IACAG;MACA,IACAC,QACAF,SADAE;MAEAJ;MACA;MACA;QACAK;UACAC;UACAC;QACA;MACA;IACA;IACAC;MAEA;QACAR;QACAK;UACAI;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACAL;QACAM;UACAX;UACA;UACA;UACA;YACA;YACAK;cACAC;cACAC;YACA;UACA;YACAP;YACA;YACA;YACA;YACAK;cACA;cACAO;cAAA;cACAD;gBACAX;gBACAa;cACA;cACAC;gBACAC;gBACAV,IACAW;kBACAC;kBACAC;gBACA,GACAC;kBACAnB;kBACA;oBACAK;sBACAM;wBACA;0BACA;0BACAN;4BACAC;4BACAC;0BACA;0BACAM;wBACA;0BACA;0BACAR;4BACAC;4BACAC;0BACA;0BACAF;4BACAC;4BACAW,kBACAG,aACA;4BACAT;8BACA;gCACAN;8BACA;4BACA;4BACAS;8BACAT;gCACAC;gCACAC;8BACA;4BACA;0BACA;wBACA;sBACA;oBACA;kBACA;kBACA;oBACA;oBACAF;sBACAC;sBACAC;oBACA;kBACA;gBACA;cACA;cACAc;gBACA;gBACA;kBACAR;gBACA;kBACAR;oBACAC;oBACAW;oBACAN;sBACA;wBACAN;sBACA;oBACA;oBACAS;sBACAT;wBACAC;wBACAC;sBACA;oBACA;kBACA;gBACA;cACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAe;MACA;MACAtB;MACAK;QACAkB;QACA;QACAZ;UACAX;UACA;UACAA;UACA;UACAa;UACAb;UACAa;UACAA;QACA;QACAC;UACAT;YACAC;YACAC;UACA;QACA;MACA;IAEA;IACAiB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACAxB;gBACAyB;kBAAA;gBAAA;gBAEAzB;gBAAA;gBAAA,OACA;kBACAS;kBACAiB;oBACA;kBACA;kBACArC;oBACA;sBACA;sBACA;oBACA;oBACA;oBACA;oBACA;oBACA;oBACA;kBACA;kBACAsC;gBAEA;cAAA;gBAlBAC;gBAmBA;gBACA;gBACA;gBACA;gBAEAC;gBACAC;gBACAzB;kBACAM;oBACAmB;kBACA;gBACA;;gBAEA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;EAAA;AAGA;AAAA,2B;;;;;;;;;;;;;AC9QA;AAAA;AAAA;AAAA;AAAknC,CAAgB,+lCAAG,EAAC,C;;;;;;;;;;;ACAtoC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/changeStation/changeStation.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/changeStation/changeStation.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./changeStation.vue?vue&type=template&id=5b7c7ce0&scoped=true&\"\nvar renderjs\nimport script from \"./changeStation.vue?vue&type=script&lang=js&\"\nexport * from \"./changeStation.vue?vue&type=script&lang=js&\"\nimport style0 from \"./changeStation.vue?vue&type=style&index=0&id=5b7c7ce0&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b7c7ce0\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/changeStation/changeStation.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./changeStation.vue?vue&type=template&id=5b7c7ce0&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./changeStation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./changeStation.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"content\">\r\n    <view class=\"nickname\">场站名\r\n      <input class=\"weui-input\" placeholder=\"请输入场所名\" v-model=\"msg.name\"/>\r\n    </view>\r\n    <view class=\"nickname\">手机号码\r\n      <input class=\"weui-input\" placeholder=\"请输入手机号码\" v-model=\"msg.phone\" />\r\n    </view>\r\n    <view class=\"nickname\">\r\n      营业时间\r\n\r\n      <input class=\"weui-input\" placeholder=\"请输入营业时间\" v-model=\"msg.hours\" />\r\n    </view>\r\n    <view class=\"nickname\">场所地址\r\n      <input class=\"weui-input\" placeholder=\"请输入场所地址\" @click=\"getLocation\" v-model=\"msg.local\" />\r\n    </view>\r\n    <view class=\"btnBuy\" @click=\"gotoChange\">\r\n      修改\r\n    </view>\r\n    <!-- <view class=\"btn\">\r\n      <checkbox></checkbox>\r\n      <view class=\"tip\">\r\n        我已阅读并同意使用<navigator url=\"../privacy/privacy.vue\">用户隐私政策</navigator>\r\n      </view>\r\n    </view> -->\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    mapMutations,\r\n    mapState\r\n  } from 'vuex'\r\n  import {\r\n    watch\r\n  } from \"vue\";\r\n  import {\r\n    checkPhone\r\n  } from 'util/util.js'\r\n  export default {\r\n    data() {\r\n      return {\r\n        msg: {\r\n          phone: uni.getStorageSync('phone'),\r\n          name: uni.getStorageSync('stationName'),\r\n          hours: uni.getStorageSync('hours'),\r\n          local: uni.getStorageSync('address'),\r\n        },\r\n        position: {\r\n          longitude: null,\r\n          latitude: null\r\n        }\r\n      }\r\n    },\r\n    methods: {\r\n      ...mapMutations('m_user', ['updatePhone','updateStationName','updateHours','updateAddress']),\r\n      onChooseAvatar(e) {\r\n        console.log(e.detail);\r\n        const {\r\n          avatarUrl\r\n        } = e.detail\r\n        // this.setData({\r\n        //   avatarUrl,\r\n        // })\r\n        console.log('e.detail', e.detail.avatarUrl)\r\n        this.avatarUrl = e.detail.avatarUrl\r\n        console.log(this.avatarUrl);\r\n        this.updateavatarurl(this.avatarUrl)\r\n        // this.updateNickname(this.nickname)\r\n        // this.uploadFile();\r\n      },\r\n      getPhone(e) {\r\n        const {\r\n          value\r\n        } = e.target;\r\n        console.log(\"手机号码检测到变化\" + value);\r\n        this.phone = value\r\n        if (!/^1[34578]\\d{9}$/.test(this.phone)) {\r\n          uni.showToast({\r\n            title: '手机格式错误',\r\n            icon: 'none'\r\n          })\r\n        }\r\n      },\r\n      gotoIndex() {\r\n\r\n        if (uni.getStorageSync('nickname') && uni.getStorageSync('avatarurl')) {\r\n          console.log(11111111);\r\n          uni.navigateTo({\r\n            url: '../../pages/index/index'\r\n          })\r\n        }\r\n      },\r\n      // 定位授权\r\n      getLocation() {\r\n        let that = this;\r\n        // 1、判断手机定位服务【GPS】 是否授权\r\n        uni.getSystemInfo({\r\n          success(res) {\r\n            console.log(\"判断手机定位服务是否授权:\", res);\r\n            let locationEnabled = res.locationEnabled; //判断手机定位服务是否开启\r\n            let locationAuthorized = res.locationAuthorized; //判断定位服务是否允许微信授权\r\n            if (locationEnabled == false || locationAuthorized == false) {\r\n              //手机定位服务（GPS）未授权\r\n              uni.showToast({\r\n                title: \"请打开手机GPS\",\r\n                icon: \"none\",\r\n              });\r\n            } else {\r\n              console.log('已授权');\r\n              //手机定位服务（GPS）已授权\r\n              // 2、判断微信小程序是否授权位置信息\r\n              // 微信小程序已授权位置信息\r\n              uni.authorize({\r\n                //授权请求窗口\r\n                scope: \"scope.userLocation\", //授权的类型\r\n                success: (res) => {\r\n                  console.log('实现fnGetlocation（）');\r\n                  that.fnGetlocation();\r\n                },\r\n                fail: (err) => {\r\n                  err = err[\"errMsg\"];\r\n                  uni\r\n                    .showModal({\r\n                      content: \"需要授权位置信息\",\r\n                      confirmText: \"确认授权\",\r\n                    })\r\n                    .then((res) => {\r\n                      console.log('是否确认授权', res);\r\n                      if (res[1][\"confirm\"]) {\r\n                        uni.openSetting({\r\n                          success: (res) => {\r\n                            if (res.authSetting[\"scope.userLocation\"]) {\r\n                              // 授权成功\r\n                              uni.showToast({\r\n                                title: \"授权成功\",\r\n                                icon: \"none\",\r\n                              });\r\n                              that.fnGetlocation();\r\n                            } else {\r\n                              // 未授权\r\n                              uni.showToast({\r\n                                title: \"授权失败,请重新授权\",\r\n                                icon: \"none\",\r\n                              });\r\n                              uni.showModal({\r\n                                title: \"授权\",\r\n                                content: \"获取授权\" +\r\n                                  authouName +\r\n                                  \"失败,是否前往授权设置？\",\r\n                                success: function(result) {\r\n                                  if (result.confirm) {\r\n                                    uni.openSetting();\r\n                                  }\r\n                                },\r\n                                fail: function() {\r\n                                  uni.showToast({\r\n                                    title: \"系统错误！\",\r\n                                    icon: \"none\",\r\n                                  });\r\n                                },\r\n                              });\r\n                            }\r\n                          },\r\n                        });\r\n                      }\r\n                      if (res[1][\"cancel\"]) {\r\n                        // 取消授权\r\n                        uni.showToast({\r\n                          title: \"你拒绝了授权，无法获得周边信息\",\r\n                          icon: \"none\",\r\n                        });\r\n                      }\r\n                    });\r\n                },\r\n                complete(res) {\r\n                  // console.log('授权弹框', res);\r\n                  if (res.errMsg == \"authorize:ok\") {\r\n                    that.fnGetlocation();\r\n                  } else {\r\n                    uni.showModal({\r\n                      title: \"授权\",\r\n                      content: \"获取授权\" + authouName + \"失败,是否前往授权设置？\",\r\n                      success: function(result) {\r\n                        if (result.confirm) {\r\n                          uni.openSetting();\r\n                        }\r\n                      },\r\n                      fail: function() {\r\n                        uni.showToast({\r\n                          title: \"系统错误！\",\r\n                          icon: \"none\",\r\n                        });\r\n                      },\r\n                    });\r\n                  }\r\n                },\r\n              });\r\n            }\r\n          },\r\n        });\r\n      },\r\n      // 定位获取\r\n      fnGetlocation() {\r\n        let that = this\r\n        console.log('开始实现fnGetlocation');\r\n        uni.chooseLocation({\r\n          type: 'wgs84',\r\n          // geocode: true, //设置该参数为true可直接获取经纬度及城市信息\r\n          success: function(res) {\r\n            console.log(res)\r\n            // that.addrDel = res;\r\n            console.log('res', res);\r\n            // that.address = res.address\r\n            that.updateAddress(res.address)\r\n            console.log('this.address', that.address);\r\n            that.position.longitude = res.longitude\r\n            that.position.latitude = res.latitude\r\n          },\r\n          fail: function() {\r\n            uni.showToast({\r\n              title: '获取地址失败，将导致部分功能不可用',\r\n              icon: 'none'\r\n            });\r\n          }\r\n        });\r\n       \r\n      },\r\n      async gotoChange() {\r\n        // const file = uni.getStorageSync('')\r\n        console.log(this.position);\r\n        const arr = Object.keys(this.position).map(item => this.position[item]);\r\n\r\n        console.log(arr);\r\n        const res = await this.request({\r\n          url: \"/map/updata\",\r\n          header:{\r\n            \"Content-Type\":\"application/json\"\r\n          },\r\n          data: {\r\n            \"location\": {\r\n              \"type\": \"Point\",\r\n              \"coordinates\": arr\r\n            },\r\n            \"mobilePhone\": this.msg.phone,\r\n            \"name\": this.msg.name,\r\n            \"hours\": this.msg.hours,\r\n            \"address\": this.msg.address,\r\n            \"status\": 0\r\n          },\r\n          method:'POST'\r\n          \r\n        })\r\n        this.updatePhone(this.msg.phone)\r\n        this.updateStationName(this.msg.name)\r\n        this.updateHours( this.msg.hours)\r\n        this.updateAddress(this.msg.local)\r\n        \r\n        let pages = getCurrentPages(); // 当前页面\r\n        let beforePage = pages[pages.length - 2]; // 上一页\r\n        uni.navigateBack({\r\n            success: function() {\r\n                beforePage.onLoad(); // 执行上一页的onLoad方法\r\n            }\r\n        });\r\n\r\n        // console.log(res);\r\n      }\r\n    }\r\n\r\n  }\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n  .content {\r\n    padding-top: 50rpx;\r\n  }\r\n\r\n  .pic {\r\n    border-bottom: 2rpx solid #f1f1f1;\r\n\r\n    .avatar-wrapper {\r\n      padding: 0;\r\n      width: 56px !important;\r\n      border-radius: 8px;\r\n      margin-top: 40px;\r\n      margin-bottom: 40px;\r\n      border-bottom: 2rpx solid #f1f1f1;\r\n    }\r\n\r\n    .avatar {\r\n      display: block;\r\n      width: 56px;\r\n      height: 56px;\r\n    }\r\n  }\r\n\r\n  .nickname {\r\n    display: flex;\r\n    border-bottom: 2rpx solid #f1f1f1;\r\n    padding: 36rpx;\r\n    justify-content: space-between;\r\n\r\n    .weui-input {\r\n      width: 70%;\r\n      border: 0;\r\n      outline: 0;\r\n      -webkit-appearance: none;\r\n      background-color: transparent;\r\n      font-size: inherit;\r\n      color: inherit;\r\n      height: 1.41176471em;\r\n      line-height: 1.41176471;\r\n      // margin-left: 50rpx;\r\n    }\r\n  }\r\n\r\n\r\n  .btnBuy {\r\n    margin: 50rpx auto 30rpx;\r\n    width: 60%;\r\n    padding: 30rpx 0;\r\n    border-radius: 20rpx;\r\n    background-color: #6792FF;\r\n    color: #fff;\r\n    text-align: center;\r\n  }\r\n\r\n  .btn {\r\n    justify-content: center;\r\n    display: flex;\r\n\r\n    & .tip {\r\n      display: flex;\r\n\r\n      & navigator {\r\n        color: #6792FF;\r\n      }\r\n    }\r\n  }\r\n</style>","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./changeStation.vue?vue&type=style&index=0&id=5b7c7ce0&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./changeStation.vue?vue&type=style&index=0&id=5b7c7ce0&scoped=true&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1680682731793\n      var cssReload = require(\"C:/Users/86150/Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}